{"version":3,"sources":["../src/components/For.ts","../src/components/Show.ts","../src/components/Switch.ts","../src/components/Portal.ts","../src/components/ErrorBoundary.ts","../src/components/Router.ts"],"names":["For","props","each","children","fallback","marker","items","parent","dispose","effect","array","node","newItems","fragment","i","item","entry","Show","when","currentNode","currentDispose","condition","untrack","Match","Switch","child","matchProps","matchChildren","Portal","mount","ErrorBoundary","error","signal","container","reset","render","fallbackNode","childNode","err","errorHandler","event","currentRoute","navigate","path","Router","routes","route","r","Link","href","restProps","a","key","value","e"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * ZenJS For Component\n *\n * High-performance keyed list rendering with fine-grained updates\n *\n * Features:\n * - Keyed reconciliation (only updates changed items)\n * - Efficient DOM operations (minimal moves)\n * - Memory efficient (reuses nodes)\n */\n\nimport { effect } from '@sylphx/zen';\nimport type { AnyZen } from '@sylphx/zen';\n\ninterface ForProps<T, U extends Node> {\n  each: T[] | AnyZen;\n  children: (item: T, index: () => number) => U;\n  fallback?: Node;\n}\n\n/**\n * For component - Keyed list rendering\n *\n * @example\n * <For each={items}>\n *   {(item, index) => <div>{item.name}</div>}\n * </For>\n */\nexport function For<T, U extends Node>(props: ForProps<T, U>): Node {\n  const { each, children, fallback } = props;\n\n  // Anchor comment node to mark position\n  const marker = document.createComment('for');\n\n  // Track rendered items\n  const items = new Map<T, { node: U; index: number; dispose?: () => void }>();\n\n  // Get parent for DOM operations\n  let parent: Node | null = null;\n\n  // Effect to update list\n  const dispose = effect(() => {\n    const array = typeof each === 'function' ? each() : each;\n\n    // Show fallback if empty\n    if (array.length === 0 && fallback) {\n      // Clear existing items\n      for (const [, { node, dispose }] of items) {\n        if (node.parentNode) {\n          node.parentNode.removeChild(node);\n        }\n        dispose?.();\n      }\n      items.clear();\n\n      // Insert fallback\n      if (!parent) parent = marker.parentNode;\n      if (parent) {\n        parent.insertBefore(fallback, marker);\n      }\n      return;\n    }\n\n    // Remove fallback if present\n    if (fallback && fallback.parentNode) {\n      fallback.parentNode.removeChild(fallback);\n    }\n\n    if (!parent) parent = marker.parentNode;\n    if (!parent) return;\n\n    // Build new items map\n    const newItems = new Map<T, { node: U; index: number; dispose?: () => void }>();\n    const fragment = document.createDocumentFragment();\n\n    for (let i = 0; i < array.length; i++) {\n      const item = array[i];\n      let entry = items.get(item);\n\n      if (entry) {\n        // Reuse existing node\n        entry.index = i;\n        newItems.set(item, entry);\n      } else {\n        // Create new node\n        const node = children(item, () => {\n          const entry = newItems.get(item);\n          return entry ? entry.index : -1;\n        });\n\n        entry = { node, index: i };\n        newItems.set(item, entry);\n      }\n\n      fragment.appendChild(entry.node);\n    }\n\n    // Remove items no longer in array\n    for (const [item, { node, dispose }] of items) {\n      if (!newItems.has(item)) {\n        if (node.parentNode) {\n          node.parentNode.removeChild(node);\n        }\n        dispose?.();\n      }\n    }\n\n    // Update items map\n    items.clear();\n    for (const [item, entry] of newItems) {\n      items.set(item, entry);\n    }\n\n    // Insert all nodes in correct order\n    parent.insertBefore(fragment, marker);\n\n    return undefined;\n  });\n\n  // Cleanup on dispose\n  (marker as any)._dispose = () => {\n    dispose();\n    for (const [, { node, dispose }] of items) {\n      if (node.parentNode) {\n        node.parentNode.removeChild(node);\n      }\n      dispose?.();\n    }\n    items.clear();\n  };\n\n  return marker;\n}\n","/**\n * ZenJS Show Component\n *\n * Conditional rendering with fine-grained reactivity\n *\n * Features:\n * - Only renders active branch\n * - Destroys inactive branch (cleanup)\n * - Supports fallback\n */\n\nimport { effect, untrack } from '@sylphx/zen';\nimport type { AnyZen } from '@sylphx/zen';\n\ninterface ShowProps<T> {\n  when: T | AnyZen | (() => T);\n  fallback?: Node | (() => Node);\n  children: Node | ((value: T) => Node);\n}\n\n/**\n * Show component - Conditional rendering\n *\n * @example\n * <Show when={isLoggedIn} fallback={<Login />}>\n *   <Dashboard />\n * </Show>\n *\n * // With function children (gets the truthy value)\n * <Show when={user}>\n *   {(u) => <div>Hello {u.name}</div>}\n * </Show>\n */\nexport function Show<T>(props: ShowProps<T>): Node {\n  const { when, fallback, children } = props;\n\n  // Anchor to mark position\n  const marker = document.createComment('show');\n\n  // Track current node\n  let currentNode: Node | null = null;\n  let currentDispose: (() => void) | undefined;\n\n  // Effect to update conditional\n  const dispose = effect(() => {\n    // Evaluate condition\n    const condition = typeof when === 'function' ? (when as Function)() : when;\n\n    // Cleanup previous\n    if (currentNode && currentNode.parentNode) {\n      currentNode.parentNode.removeChild(currentNode);\n      currentNode = null;\n    }\n    if (currentDispose) {\n      currentDispose();\n      currentDispose = undefined;\n    }\n\n    // Render appropriate branch\n    if (condition) {\n      // Truthy - render children\n      currentNode = untrack(() => {\n        if (typeof children === 'function') {\n          return children(condition as T);\n        }\n        return children;\n      });\n    } else if (fallback) {\n      // Falsy - render fallback\n      currentNode = untrack(() => {\n        if (typeof fallback === 'function') {\n          return fallback();\n        }\n        return fallback;\n      });\n    }\n\n    // Insert into DOM\n    if (currentNode && marker.parentNode) {\n      marker.parentNode.insertBefore(currentNode, marker);\n\n      // Store dispose if available\n      if ((currentNode as any)._dispose) {\n        currentDispose = (currentNode as any)._dispose;\n      }\n    }\n\n    return undefined;\n  });\n\n  // Cleanup\n  (marker as any)._dispose = () => {\n    dispose();\n    if (currentNode && currentNode.parentNode) {\n      currentNode.parentNode.removeChild(currentNode);\n    }\n    if (currentDispose) {\n      currentDispose();\n    }\n  };\n\n  return marker;\n}\n","/**\n * ZenJS Switch/Match Components\n *\n * Multi-branch conditional rendering\n *\n * Features:\n * - Only renders first matching branch\n * - Efficient branch switching\n * - Supports fallback\n */\n\nimport { effect, untrack } from '@sylphx/zen';\nimport type { AnyZen } from '@sylphx/zen';\n\ninterface SwitchProps {\n  fallback?: Node | (() => Node);\n  children: Node[];\n}\n\ninterface MatchProps<T> {\n  when: T | AnyZen | (() => T);\n  children: Node | ((value: T) => Node);\n}\n\n/**\n * Match component - Single branch in Switch\n *\n * @example\n * <Match when={route === 'home'}>\n *   <Home />\n * </Match>\n */\nexport function Match<T>(props: MatchProps<T>): Node {\n  const marker = document.createComment('match');\n\n  // Store props for Switch to access\n  (marker as any)._matchProps = props;\n\n  return marker;\n}\n\n/**\n * Switch component - Multi-branch conditional\n *\n * @example\n * <Switch fallback={<NotFound />}>\n *   <Match when={route === 'home'}><Home /></Match>\n *   <Match when={route === 'about'}><About /></Match>\n * </Switch>\n */\nexport function Switch(props: SwitchProps): Node {\n  const { fallback, children } = props;\n\n  // Anchor\n  const marker = document.createComment('switch');\n\n  // Track current node\n  let currentNode: Node | null = null;\n  let currentDispose: (() => void) | undefined;\n\n  // Effect to evaluate conditions\n  const dispose = effect(() => {\n    // Cleanup previous\n    if (currentNode && currentNode.parentNode) {\n      currentNode.parentNode.removeChild(currentNode);\n      currentNode = null;\n    }\n    if (currentDispose) {\n      currentDispose();\n      currentDispose = undefined;\n    }\n\n    // Find first matching branch\n    for (const child of children) {\n      const matchProps = (child as any)._matchProps;\n\n      if (matchProps) {\n        const { when, children: matchChildren } = matchProps;\n\n        // Evaluate condition\n        const condition = typeof when === 'function' ? when() : when;\n\n        if (condition) {\n          // Found match - render\n          currentNode = untrack(() => {\n            if (typeof matchChildren === 'function') {\n              return matchChildren(condition);\n            }\n            return matchChildren;\n          });\n\n          break;\n        }\n      }\n    }\n\n    // No match - render fallback\n    if (!currentNode && fallback) {\n      currentNode = untrack(() => {\n        if (typeof fallback === 'function') {\n          return fallback();\n        }\n        return fallback;\n      });\n    }\n\n    // Insert into DOM\n    if (currentNode && marker.parentNode) {\n      marker.parentNode.insertBefore(currentNode, marker);\n\n      if ((currentNode as any)._dispose) {\n        currentDispose = (currentNode as any)._dispose;\n      }\n    }\n\n    return undefined;\n  });\n\n  // Cleanup\n  (marker as any)._dispose = () => {\n    dispose();\n    if (currentNode && currentNode.parentNode) {\n      currentNode.parentNode.removeChild(currentNode);\n    }\n    if (currentDispose) {\n      currentDispose();\n    }\n  };\n\n  return marker;\n}\n","/**\n * ZenJS Portal Component\n *\n * Render children into a different part of the DOM tree\n *\n * Features:\n * - Render outside parent hierarchy\n * - Useful for modals, tooltips, popovers\n * - Maintains reactive context\n */\n\ninterface PortalProps {\n  mount?: Element;\n  children: Node;\n}\n\n/**\n * Portal component - Render children into different DOM location\n *\n * @example\n * <Portal mount={document.body}>\n *   <Modal>...</Modal>\n * </Portal>\n */\nexport function Portal(props: PortalProps): Node {\n  const { mount = document.body, children } = props;\n\n  // Create marker\n  const marker = document.createComment('portal');\n\n  // Mount children to target\n  if (children instanceof Node) {\n    mount.appendChild(children);\n  }\n\n  // Cleanup on dispose\n  (marker as any)._dispose = () => {\n    if (children instanceof Node && children.parentNode === mount) {\n      mount.removeChild(children);\n    }\n  };\n\n  return marker;\n}\n","/**\n * ZenJS ErrorBoundary Component\n *\n * Catch and handle errors in component tree\n *\n * Features:\n * - Catch render errors\n * - Display fallback UI\n * - Error recovery\n */\n\nimport { zen as signal } from '@sylphx/zen';\n\ninterface ErrorBoundaryProps {\n  fallback: (error: Error, reset: () => void) => Node;\n  children: Node | (() => Node);\n}\n\n/**\n * ErrorBoundary component - Catch errors in component tree\n *\n * @example\n * <ErrorBoundary fallback={(error, reset) => (\n *   <div>\n *     <h1>Error: {error.message}</h1>\n *     <button onClick={reset}>Retry</button>\n *   </div>\n * )}>\n *   <App />\n * </ErrorBoundary>\n */\nexport function ErrorBoundary(props: ErrorBoundaryProps): Node {\n  const { fallback, children } = props;\n\n  const error = signal<Error | null>(null);\n  const container = document.createElement('div');\n\n  const reset = () => {\n    error.value = null;\n    render();\n  };\n\n  const render = () => {\n    try {\n      // Clear container\n      container.innerHTML = '';\n\n      if (error.value) {\n        // Show fallback\n        const fallbackNode = fallback(error.value, reset);\n        container.appendChild(fallbackNode);\n      } else {\n        // Show children\n        const childNode = typeof children === 'function' ? children() : children;\n        container.appendChild(childNode);\n      }\n    } catch (err) {\n      error.value = err as Error;\n      // Retry render with error state\n      const fallbackNode = fallback(err as Error, reset);\n      container.innerHTML = '';\n      container.appendChild(fallbackNode);\n    }\n  };\n\n  // Initial render\n  render();\n\n  // Global error handler (optional - catches async errors)\n  const errorHandler = (event: ErrorEvent) => {\n    if (container.contains(event.target as Node)) {\n      event.preventDefault();\n      error.value = event.error;\n      render();\n    }\n  };\n\n  window.addEventListener('error', errorHandler);\n\n  // Cleanup\n  (container as any)._dispose = () => {\n    window.removeEventListener('error', errorHandler);\n  };\n\n  return container;\n}\n","/**\n * ZenJS Simple Router\n *\n * Client-side routing without page reload\n *\n * Features:\n * - Hash-based routing\n * - Reactive route matching\n * - Navigation with history\n */\n\nimport { zen as signal, computed, effect, untrack } from '@sylphx/zen';\n\n// Current route (lazy initialization for SSR/test compatibility)\nexport const currentRoute = signal(\n  typeof window !== 'undefined' ? window.location.hash.slice(1) || '/' : '/'\n);\n\n// Navigate to route\nexport function navigate(path: string) {\n  if (typeof window !== 'undefined') {\n    window.location.hash = path;\n  }\n}\n\n// Listen to hash changes (browser only)\nif (typeof window !== 'undefined') {\n  window.addEventListener('hashchange', () => {\n    currentRoute.value = window.location.hash.slice(1) || '/';\n  });\n}\n\ninterface RouteProps {\n  path: string;\n  component: () => Node;\n}\n\ninterface RouterProps {\n  routes: RouteProps[];\n  fallback?: () => Node;\n}\n\n/**\n * Router component - Client-side routing\n *\n * @example\n * <Router routes={[\n *   { path: '/', component: () => <Home /> },\n *   { path: '/about', component: () => <About /> },\n * ]} />\n */\nexport function Router(props: RouterProps): Node {\n  const { routes, fallback } = props;\n\n  const marker = document.createComment('router');\n  let currentNode: Node | null = null;\n  let currentDispose: (() => void) | undefined;\n\n  // Effect to update on route change\n  const dispose = effect(() => {\n    // Get current route\n    const path = currentRoute.value;\n    const route = routes.find(r => r.path === path) || null;\n\n    // Cleanup previous\n    if (currentNode && currentNode.parentNode) {\n      currentNode.parentNode.removeChild(currentNode);\n      currentNode = null;\n    }\n    if (currentDispose) {\n      currentDispose();\n      currentDispose = undefined;\n    }\n\n    // Render new route\n    currentNode = untrack(() => {\n      if (route) {\n        return route.component();\n      } else if (fallback) {\n        return fallback();\n      } else {\n        return document.createTextNode('404 Not Found');\n      }\n    });\n\n    // Insert into DOM\n    if (currentNode && marker.parentNode) {\n      marker.parentNode.insertBefore(currentNode, marker);\n\n      if ((currentNode as any)._dispose) {\n        currentDispose = (currentNode as any)._dispose;\n      }\n    }\n\n    return undefined;\n  });\n\n  // Cleanup\n  (marker as any)._dispose = () => {\n    dispose();\n    if (currentNode && currentNode.parentNode) {\n      currentNode.parentNode.removeChild(currentNode);\n    }\n    if (currentDispose) {\n      currentDispose();\n    }\n  };\n\n  return marker;\n}\n\n/**\n * Link component - Navigation link\n */\ninterface LinkProps {\n  href: string;\n  children: Node | string;\n  class?: string;\n}\n\nexport function Link(props: LinkProps): Node {\n  const { href, children, ...restProps } = props;\n\n  const a = document.createElement('a');\n  a.href = `#${href}`;\n\n  // Set attributes\n  for (const [key, value] of Object.entries(restProps)) {\n    if (key === 'class') {\n      a.className = String(value);\n    } else {\n      a.setAttribute(key, String(value));\n    }\n  }\n\n  // Append children\n  if (typeof children === 'string') {\n    a.textContent = children;\n  } else if (children instanceof Node) {\n    a.appendChild(children);\n  }\n\n  // Prevent default and navigate\n  a.addEventListener('click', (e) => {\n    e.preventDefault();\n    navigate(href);\n  });\n\n  return a;\n}\n"]}