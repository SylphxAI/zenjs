{"version":3,"sources":["../src/core/effect.ts","../src/core/fragment.ts","../src/jsx-runtime.ts"],"names":["currentEffect","effect","fn","eff","dep","previousEffect","result","untrack","Fragment","props","fragment","children","child","jsx","type","restProps","element","key","value","setAttribute","appendChild","jsxs","eventName","signal","setStaticAttribute","parent","c","textNode","render","component","container","node"],"mappings":"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","file":"chunk-JKDCSUMF.js","sourcesContent":["/**\n * ZenJS Core - Effect Implementation\n *\n * Tracks dependencies and re-runs when they change\n */\n\nexport interface Effect {\n  fn: () => void;\n  dependencies: Set<any>;\n  cleanup?: () => void;\n  _isRunning: boolean;\n  _disposed: boolean;\n}\n\n// Global effect stack for dependency tracking\nconst effectStack: Effect[] = [];\n\nexport let currentEffect: Effect | undefined;\n\n/**\n * Create an effect that runs when dependencies change\n */\nexport function effect(fn: () => void | (() => void)): () => void {\n  const eff: Effect = {\n    fn: () => {\n      if (eff._disposed) return;\n\n      // Cleanup previous run\n      if (eff.cleanup) {\n        eff.cleanup();\n        eff.cleanup = undefined;\n      }\n\n      // Remove from old dependencies\n      for (const dep of eff.dependencies) {\n        if (dep._removeSubscriber) {\n          dep._removeSubscriber(eff);\n        }\n      }\n\n      // Clear old dependencies\n      eff.dependencies.clear();\n\n      // Run with tracking\n      const previousEffect = currentEffect;\n      currentEffect = eff;\n      eff._isRunning = true;\n\n      try {\n        const result = fn();\n        if (typeof result === 'function') {\n          eff.cleanup = result;\n        }\n      } finally {\n        currentEffect = previousEffect;\n        eff._isRunning = false;\n      }\n    },\n    dependencies: new Set(),\n    _isRunning: false,\n    _disposed: false,\n  };\n\n  // Run immediately\n  eff.fn();\n\n  // Return dispose function\n  return () => {\n    eff._disposed = true;\n\n    if (eff.cleanup) {\n      eff.cleanup();\n    }\n\n    // Remove from all dependencies\n    for (const dep of eff.dependencies) {\n      if (dep._removeSubscriber) {\n        dep._removeSubscriber(eff);\n      }\n    }\n\n    eff.dependencies.clear();\n  };\n}\n\n/**\n * Run a function without tracking dependencies\n */\nexport function untrack<T>(fn: () => T): T {\n  const previousEffect = currentEffect;\n  currentEffect = undefined;\n  try {\n    return fn();\n  } finally {\n    currentEffect = previousEffect;\n  }\n}\n","/**\n * Fragment component for grouping children\n */\n\nexport function Fragment(props: { children?: any }): DocumentFragment {\n  const fragment = document.createDocumentFragment();\n\n  if (props.children) {\n    const children = Array.isArray(props.children)\n      ? props.children\n      : [props.children];\n\n    for (const child of children) {\n      if (child instanceof Node) {\n        fragment.appendChild(child);\n      } else if (child) {\n        fragment.appendChild(document.createTextNode(String(child)));\n      }\n    }\n  }\n\n  return fragment;\n}\n","/**\n * ZenJS JSX Runtime\n *\n * Renders JSX to fine-grained reactive DOM\n */\n\nimport { effect } from './core/effect.js';\nimport type { Signal } from './core/signal.js';\n\nexport { Fragment } from './core/fragment.js';\n\ntype Props = Record<string, any>;\ntype Child = Node | string | number | boolean | null | undefined;\n\n/**\n * JSX factory function\n */\nexport function jsx(\n  type: string | Function,\n  props: Props | null,\n): Node {\n  const { children, ...restProps } = props || {};\n\n  // Component\n  if (typeof type === 'function') {\n    return type({ ...restProps, children });\n  }\n\n  // Element\n  const element = document.createElement(type);\n\n  // Set properties and attributes\n  if (restProps) {\n    for (const [key, value] of Object.entries(restProps)) {\n      setAttribute(element, key, value);\n    }\n  }\n\n  // Append children\n  if (children !== undefined) {\n    appendChild(element, children);\n  }\n\n  return element;\n}\n\nexport const jsxs = jsx;\n\n/**\n * Set attribute/property on element\n */\nfunction setAttribute(element: Element, key: string, value: any): void {\n  // Event listener\n  if (key.startsWith('on')) {\n    const eventName = key.slice(2).toLowerCase();\n    element.addEventListener(eventName, value);\n    return;\n  }\n\n  // Reactive value\n  if (typeof value === 'function' && '_version' in value) {\n    const signal = value as Signal;\n    effect(() => {\n      setStaticAttribute(element, key, signal());\n    });\n    return;\n  }\n\n  // Static value\n  setStaticAttribute(element, key, value);\n}\n\n/**\n * Set static attribute value\n */\nfunction setStaticAttribute(element: Element, key: string, value: any): void {\n  // Class name\n  if (key === 'className' || key === 'class') {\n    element.className = String(value);\n    return;\n  }\n\n  // Style\n  if (key === 'style') {\n    if (typeof value === 'string') {\n      (element as HTMLElement).style.cssText = value;\n    } else if (typeof value === 'object') {\n      Object.assign((element as HTMLElement).style, value);\n    }\n    return;\n  }\n\n  // Property vs attribute\n  if (key in element) {\n    (element as any)[key] = value;\n  } else {\n    element.setAttribute(key, String(value));\n  }\n}\n\n/**\n * Append child to element\n */\nfunction appendChild(parent: Element, child: any): void {\n  if (child === null || child === undefined || child === false) {\n    return;\n  }\n\n  // Array of children\n  if (Array.isArray(child)) {\n    for (const c of child) {\n      appendChild(parent, c);\n    }\n    return;\n  }\n\n  // Reactive child\n  if (typeof child === 'function' && '_version' in child) {\n    const signal = child as Signal;\n    const textNode = document.createTextNode('');\n    parent.appendChild(textNode);\n\n    effect(() => {\n      const value = signal();\n      textNode.data = String(value ?? '');\n    });\n    return;\n  }\n\n  // Node\n  if (child instanceof Node) {\n    parent.appendChild(child);\n    return;\n  }\n\n  // Text\n  parent.appendChild(document.createTextNode(String(child)));\n}\n\n/**\n * Render component to container\n */\nexport function render(component: () => Node, container: Element): () => void {\n  const node = component();\n  container.appendChild(node);\n\n  return () => {\n    container.removeChild(node);\n  };\n}\n"]}